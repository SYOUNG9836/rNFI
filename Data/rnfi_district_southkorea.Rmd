---
title: "Read Administrative district"
author: "Wonhee Cho, Sinyoung Park, Dongwook W. Ko"
date: "1/11/2021"
output: html_document
---
This document explan how we read administrative district in South Korea.
In our package we used several packages for read district shapefiles and represented district code with names.

#Install packages

```{r setup packages}
#install.packages("raster")
library(raster)
library(rgdal)
```

## Read district shape files

In our package, we used three levels of dvision in our districts; "do" (First level), "Si-gun-gu (sgg)" (Second level), "eup-myeon-dong (emd)" (third level).

District data from "GIS Developer (http://www.gisdeveloper.co.kr)"


```{r districts}
do <- shapefile("./sido_202005/CTPRVN.shp")
sgg <- shapefile("./sigungu_202005/SIG.shp")
emd <- shapefile("./EMD_202005/EMD.shp")
do$CTPRVN_CD <- as.numeric(do$CTPRVN_CD)
sgg$SIG_CD <- as.numeric(sgg$SIG_CD)
emd$EMD_CD <- as.numeric(emd$EMD_CD)
```

## Read district code and explanation

We also supply our district code with names (in Englsih)
So, It is consist of 2 variables (Code & district name).
The "do" is consist of 17 codes, "sgg" is consist of 250 codes and "emd" is consist of 5,047 codes.
So, you can read your NFI (National Forest Inventory) data on your specific area.

```{r distrcit names}
####"do" level codes and names
do_hdname <- c("do_cd", "do_name")
do_cd <- data.frame(do[,1:2])
colnames(do_cd) <- do_hdname
print(do_cd)

####"si-gun-gu" level codes and names
sgg_hdname <- c("sgg_cd", "sgg_name")
sgg_cd <- data.frame(sgg[,1:2])
colnames(sgg_cd) <- sgg_hdname
print(sgg_cd)

####"eup-myeon-dong" level codes and names
emd_hdname <- c("emd_cd", "emd_name")
emd_cd <- data.frame(emd[,1:2])
colnames(emd_cd) <- emd_hdname
print(emd_cd)
```

## Read NFI (National Forest Inventory) survey point 

In here, we read our NFI survey point and clip it in specific area.

```{r read NFI survey point}
####read NFI point with the same coordinate reference system in district shape files
####EPSG:5179
nfi_point <- shapefile("./nfi_point/samplepoint.shp")
nfi_point<-spTransform(nfi_point, CRS=proj4string(sgg))


```



```{r clip NFI point in specific area}


#dis_order <- 11


clip_NFI <- function(NFI_point, District_code){
  
  region <- if(District_code< 99){
    do[do$CTPRVN_CD == District_code, ]
  }else if(District_code<99999 & District_code>100){
      sgg[sgg$SIG_CD == District_code, ]
  }else{
      emd[emd$EMD_CD == District_code, ]}
  
  
  
 
  clip_point<-intersect(nfi_point,region)
  
  return(clip_point)
  
  }

plot(region)
clip_plot<-plot(clip_point,add=T)
clip_region<-clip_NFI(nfi_point,11)
clip_region$SP_ID



 
```



